# Frame for Raspberry Pi üñºÔ∏è\n\nA pluggable image frame built on Flask and a Waveshare e‚ÄëInk display. The dashboard lets you upload pictures, fetch them from external services, and trigger refreshes either manually or on a schedule.\n\n## Features\n- Web dashboard for uploading images and managing configuration\n- Pluggable image sources (DeviantArt, Plex, fixed images, or custom plugins)\n- Optional scheduler for periodic refreshes\n- REST API protected by bearer token\n- Runs on Raspberry Pi with Waveshare e‚ÄëInk display\n- Initial web-based setup for easy configuration\n- Support for multiple environment files\n\n## Architecture\n```mermaid\ngraph TD\n    A[Browser] -->|HTTP| B[Flask dashboard]\n    B --> E[frame/download.py]\n    S[Scheduler] --> E\n    E -->|image| F[frame/display.py]\n    E --> G[Plugins]\n```\n\n## Quickstart\n1. **Clone and enter the repository**\n   ```bash\n   git clone https://github.com/your-user/Frame.git\n   cd Frame\n   ```\n2. **(Optional) Create a virtual environment**\n   ```bash\n   python -m venv .venv\n   source .venv/bin/activate\n   ```\n3. **Install dependencies**\n   ```bash\n   pip install -r requirements.txt\n   ```\n4. **Run the dashboard**\n   ```bash\n   python dashboard.py\n   ```\n5. **Configure via web interface**\n   Visit http://localhost:5000 to access the initial setup wizard.\n\n## Configuration\nEnvironment variables control behaviour. On first access, you'll be guided through a web-based setup process to configure these variables.\n\nAlternatively, you can manually create a `.env` file:\n```bash\ncp .env.example .env\n# edit .env with your API_TOKEN, DeviantArt and Plex credentials, etc.\n```\n\n| Variable | Description |\n|---|---|\n| `API_TOKEN` | Bearer token required for API requests |\n| `DEVIANTART_CLIENT_ID`, `DEVIANTART_CLIENT_SECRET` | DeviantArt credentials |\n| `PLEX_URL`, `PLEX_TOKEN`, `PLEX_LIBRARY` | Plex server info |\n| `UPDATE_INTERVAL` | Seconds between automatic refreshes (0 disables scheduler)\n\n### Multiple Environment Files\nYou can use different environment files by setting the `ENV_FILE` environment variable:\n```bash\nENV_FILE=.env.production python dashboard.py\n```\n\n## Getting Your API Token\n\nAfter initial setup, you can find your API token in two ways:\n\n1. **Via the web interface**: Navigate to the \"API Token\" page in the dashboard to view and copy your token.\n\n2. **Via the API**: If you know your current token, you can retrieve it with:\n   ```bash\n   curl -H 'Authorization: Bearer YOUR_CURRENT_TOKEN' http://your-frame-ip:5000/api/token\n   ```\n\nDuring the initial setup, if you don't provide an API token, a secure one will be automatically generated for you.\n\n## API Usage\n\nThe Frame API is protected by a bearer token that you set during the initial configuration. Include this token in the `Authorization` header of your requests:\n\n```\nAuthorization: Bearer YOUR_API_TOKEN\n```\n\n### Upload Image from URL\n\nYou can upload an image to the frame by providing a URL to the image:\n\n```bash\ncurl -X POST \\\n  http://your-frame-ip:5000/api/upload_url \\\n  -H 'Authorization: Bearer YOUR_API_TOKEN' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"url\": \"https://example.com/image.jpg\"}'\n```\n\n### Upload Image File\n\nYou can also upload an image file directly:\n\n```bash\ncurl -X POST \\\n  http://your-frame-ip:5000/api/upload \\\n  -H 'Authorization: Bearer YOUR_API_TOKEN' \\\n  -F 'image=@/path/to/your/image.jpg'\n```\n\n### Trigger Image Update\n\nTo trigger an immediate update of the frame display:\n\n```bash\ncurl -X POST \\\n  http://your-frame-ip:5000/api/new \\\n  -H 'Authorization: Bearer YOUR_API_TOKEN'\n```\n\n### Set Image Source\n\nYou can configure which image source the frame should use (DeviantArt, Plex, or fixed):\n\n```bash\ncurl -X POST \\\n  http://your-frame-ip:5000/api/function \\\n  -H 'Authorization: Bearer YOUR_API_TOKEN' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"function\": \"DeviantArt\"}'\n```\n\nReplace `\"DeviantArt\"` with `\"plex\"` or `\"fixed\"` as needed.\n\n## Development\n\n### Running Tests\n\nThe project includes automated tests to ensure everything works correctly:\n\n```bash\n# Run all tests\npytest\n\n# Run specific test files\npython -m pytest tests/test_app.py -v\npython -m pytest tests/test_upload_api.py -v\n```\n\n### Code Quality Checks\n\nBefore committing, run these checks:\n\n```bash\n# Check Python syntax\npython -m py_compile dashboard.py frame/*.py\n\n# Linting\nflake8 .\n\n# Type checking\nmypy .\n\n# Format code (optional)\nblack tests\n```\n\n### Continuous Integration\n\nThis project uses GitHub Actions for continuous integration. The CI workflow runs automatically on every push and pull request, performing these checks:\n\n1. Install dependencies\n2. Check Python syntax\n3. Run linting (flake8, black)\n4. Run type checking (mypy)\n5. Run unit tests (pytest)\n6. Test application startup\n7. Test application functionality\n\nYou can view the CI status in the \"Actions\" tab of the GitHub repository.\n\n## Deployment\n\n### Installation Script (Raspberry Pi)\n\nOn Raspberry Pi, run:\n\n```bash\nsudo ./install.sh\n```\n\nThis script will:\n1. Copy the project to `/home/pi/Frame`\n2. Create a Python virtual environment\n3. Install all dependencies in the virtual environment\n4. Set up and start the systemd service\n5. Install an update script for easy future updates\n\n### Updating the Software\n\nAfter installation, you can update the Frame software at any time by running:\n\n```bash\nsudo frame-update\n```\n\nThis update script will:\n1. Backup your configuration files (`.env`)\n2. Fetch the latest changes from the GitHub repository\n3. Update the code if there are changes\n4. Update any new or changed dependencies\n5. Restart the service to apply changes\n\n### Docker\n\nBuild and run inside a container:\n\n```bash\ndocker build -t frame .\ndocker run --env-file .env -p 5000:5000 frame\n```\n\n## Extending\nCreate a module that downloads an image and register it:\n\n```python\nfrom frame.plugins import register_plugin\n\ndef my_source(destination: str) -> None:\n    # download image to destination\n\nregister_plugin(\"my_source\", my_source)\n```\n\n## License\n[MIT](LICENSE)\n\nMerci et bonne journ√©e !
